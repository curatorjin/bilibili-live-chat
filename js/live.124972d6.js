(function(e){function t(t){for(var a,u,i=t[0],o=t[1],s=t[2],f=0,b=[];f<i.length;f++)u=i[f],Object.prototype.hasOwnProperty.call(r,u)&&r[u]&&b.push(r[u][0]),r[u]=0;for(a in o)Object.prototype.hasOwnProperty.call(o,a)&&(e[a]=o[a]);l&&l(t);while(b.length)b.shift()();return c.push.apply(c,s||[]),n()}function n(){for(var e,t=0;t<c.length;t++){for(var n=c[t],a=!0,i=1;i<n.length;i++){var o=n[i];0!==r[o]&&(a=!1)}a&&(c.splice(t--,1),e=u(u.s=n[0]))}return e}var a={},r={live:0},c=[];function u(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,u),n.l=!0,n.exports}u.m=e,u.c=a,u.d=function(e,t,n){u.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},u.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},u.t=function(e,t){if(1&t&&(e=u(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(u.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)u.d(n,a,function(t){return e[t]}.bind(null,a));return n},u.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return u.d(t,"a",t),t},u.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},u.p="";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],o=i.push.bind(i);i.push=t,i=i.slice();for(var s=0;s<i.length;s++)t(i[s]);var l=o;c.push([1,"chunk-common","chunk-live-vendors"]),n()})({1:function(e,t,n){e.exports=n("bf33")},2:function(e,t){},"2c9b":function(e,t,n){"use strict";n("39ab")},"39ab":function(e,t,n){},"3ce6":function(e,t,n){"use strict";n("cd73")},"3ff3":function(e,t,n){},4998:function(e,t,n){"use strict";n("f21b")},"8ff9":function(e,t,n){},bca3:function(e,t,n){"use strict";n("8ff9")},bf33:function(e,t,n){"use strict";n.r(t);n("e623"),n("e379"),n("5dc8"),n("37e1"),n("5595");var a=n("7a23");function r(e,t,n,r,c,u){var i=Object(a["y"])("danmaku-item"),o=Object(a["y"])("live");return r.errMsg?(Object(a["q"])(),Object(a["d"])(i,{key:0,type:"info",message:r.errMsg},null,8,["message"])):r.ready?(Object(a["q"])(),Object(a["d"])(o,Object(a["m"])(Object(a["j"])({key:1},r.props)),null,16)):Object(a["e"])("",!0)}n("18a5");var c=n("f6cc"),u=(n("d3b7"),n("ac1f"),n("5319"),n("72bf")),i=!0,o=function(e){return i=e},s=function(e){return fetch(e).then((function(e){return e.json()}))},l=function(e){return fetch("https://json2jsonp.com/?".concat(Object(u["stringify"])({url:e,callback:"_"}))).then((function(e){return e.text()})).then((function(e){return JSON.parse(e.replace(/^_\((.*)\)$/,"$1"))}))},f=function(e){return i?s(e):l(e)},b=(n("99af"),n("4de4"),n("a630"),n("caad"),n("d81d"),n("4ec9"),n("a9e3"),n("4fad"),n("2532"),n("3ca3"),n("1276"),n("ddb0"),n("96cf"),n("1da1")),d=n("3835"),p=n("4416"),j=n.n(p),m=n("3bb8"),v=n.n(m),O=n("b047"),g=n.n(O),h=n("5d2d"),k=function(){return Math.floor(Date.now()/864e5)},y={method:"false",expireDay:7},w=function(e){return Object.assign(y,e)},x=function(e){switch(y.method){case"imjad":return s("https://api.imjad.cn/bilibili/v2/?get=space&vmid=".concat(e,"&pagesize=1")).then((function(e){var t,n;return null===(t=e.data)||void 0===t||null===(n=t.card)||void 0===n?void 0:n.face}));default:return f("https://api.bilibili.com/x/space/acc/info?mid=".concat(e)).then((function(e){var t;return null===(t=e.data)||void 0===t?void 0:t.face}))}},S=function(e){var t=Object(d["a"])(e,2),n=t[0],a=t[1];a||(a="member/noface.jpg");var r=j()(a.split(".")),c="https://i".concat(n,".hdslb.com/bfs/face/").concat(a);return"gif"===r?[[c,0]]:[["".concat(c,"_48x48.").concat(r),2e3],[c,5e3]]},L=function(e){var t=Object(d["a"])(e,3),n=t[2];return!n||k()-n>=y.expireDay},R=new Map(Object.entries(Object(h["a"])("face",{})).filter((function(e){var t=Object(d["a"])(e,2),n=t[1];return!L(n)})).map((function(e){var t=Object(d["a"])(e,2),n=t[0],a=t[1];return[Number(n),a]}))),q=g()((function(){return Object(h["b"])("face",v()(Array.from(R)))}),5e3,{maxWait:5e3}),_=function(e,t){var n;if(t){var a=parseInt(null===(n=/\/\/i(\d+)\./.exec(t))||void 0===n?void 0:n[1])||0,r=j()(t.split("/")),c=r.includes("noface")?[0,null,k()]:[a,r,k()];return R.set(e,c),q(),c}},T=function(){var e=Object(b["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=R.get(t),!n||L(n)){e.next=3;break}return e.abrupt("return",S(n));case 3:return e.prev=3,e.t0=S,e.t1=_,e.t2=t,e.next=9,x(t);case 9:return e.t3=e.sent,e.t4=(0,e.t1)(e.t2,e.t3),e.abrupt("return",(0,e.t0)(e.t4));case 14:e.prev=14,e.t5=e["catch"](3),console.error("[face API error]",e.t5);case 17:return e.abrupt("return",S([0,null]));case 18:case"end":return e.stop()}}),e,null,[[3,14]])})));return function(t){return e.apply(this,arguments)}}(),E={id:"live"};function P(e,t,n,r,c,u){var i=Object(a["y"])("jukebox"),o=Object(a["y"])("danmaku-list");return Object(a["q"])(),Object(a["f"])("div",E,[Object(a["i"])(i,Object(a["j"])({ref:"jukebox"},r.props),null,16),r.props.giftPin?(Object(a["q"])(),Object(a["d"])(o,Object(a["j"])({key:0,ref:"giftPinList"},r.props,{"gift-show-face":r.giftShowFace,"is-gift-list":!0}),null,16,["gift-show-face"])):Object(a["e"])("",!0),Object(a["i"])(o,Object(a["j"])({ref:"danmakuList"},r.props),null,16)])}n("2ca0");var A=n("5530"),I=n("fcfc"),D={key:0,class:"danmaku-list-pinned",ref:"danmakuListRef"},M={class:"danmaku-list hidden"},N={class:"danmaku-list absolute",ref:"giftListRef"},z={key:1,class:"danmaku-list",ref:"danmakuListRef"},C={key:0,class:"danmaku-list-placeholder"};function F(e,t,n,r,c,u){var i=Object(a["y"])("danmaku-item");return n.isGiftList?(Object(a["q"])(),Object(a["f"])("div",D,[Object(a["g"])("div",M,[(Object(a["q"])(!0),Object(a["f"])(a["a"],null,Object(a["w"])(e.giftPin,(function(e){return Object(a["q"])(),Object(a["d"])(i,{key:e,"show-face":n.giftShowFace,type:"gift",uname:"某人",giftName:"礼物",num:e},null,8,["show-face","num"])})),128))]),Object(a["g"])("div",N,[(Object(a["q"])(!0),Object(a["f"])(a["a"],null,Object(a["w"])(r.danmakuList,(function(e){return Object(a["q"])(),Object(a["d"])(i,Object(a["j"])({key:e.key},e.props,{hidden:e.hidden,ref:function(t){return e.el=t}}),null,16,["hidden"])})),128))],512)],512)):(Object(a["q"])(),Object(a["f"])("div",z,["bottom"===e.display?(Object(a["q"])(),Object(a["f"])("div",C)):Object(a["e"])("",!0),(Object(a["q"])(!0),Object(a["f"])(a["a"],null,Object(a["w"])(r.danmakuList,(function(e){return Object(a["q"])(),Object(a["d"])(i,Object(a["j"])({key:e.key},e.props,{hidden:e.hidden,ref:function(t){return e.el=t}}),null,16,["hidden"])})),128))],512))}n("7db0"),n("c740"),n("4160"),n("a434"),n("b64b"),n("159b");var G=n("443d"),B=n.n(G),H=n("ec26"),J=n("53ca"),U=n("b85c"),W=function(e,t){return new Promise((function(n,a){var r=0,c=new XMLHttpRequest,u=setTimeout((function(){c.abort()}),1e4),i=t?setTimeout((function(){0===r&&c.abort()}),t):null;c.open("GET",e,!0),c.onprogress=function(e){e.lengthComputable&&(r=e.loaded/e.total)},c.onload=function(){clearTimeout(i),clearTimeout(u),n(e)},c.onerror=a,c.onabort=a,c.send()}))},X=function(){var e=Object(b["a"])(regeneratorRuntime.mark((function e(t){var n,a,r,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:n=Object(U["a"])(t),e.prev=1,r=regeneratorRuntime.mark((function e(){var t,n,r,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=Object(d["a"])(a.value,2),n=t[0],r=t[1],e.next=3,W(n,r).catch((function(){console.warn("Timeout",n)}));case 3:if(c=e.sent,!c){e.next=6;break}return e.abrupt("return",{v:c});case 6:case"end":return e.stop()}}),e)})),n.s();case 4:if((a=n.n()).done){e.next=11;break}return e.delegateYield(r(),"t0",6);case 6:if(c=e.t0,"object"!==Object(J["a"])(c)){e.next=9;break}return e.abrupt("return",c.v);case 9:e.next=4;break;case 11:e.next=16;break;case 13:e.prev=13,e.t1=e["catch"](1),n.e(e.t1);case 16:return e.prev=16,n.f(),e.finish(16);case 19:return e.abrupt("return",t[0][0]||"");case 20:case"end":return e.stop()}}),e,null,[[1,13,16,19]])})));return function(t){return e.apply(this,arguments)}}(),$={key:1,class:"danmaku-content"},Y={class:"danmaku-message"},K={key:2,class:"danmaku-content"},Q=Object(a["g"])("span",{class:"danmaku-message"},"感谢 ",-1),V={class:"danmaku-author-name"},Z=Object(a["g"])("span",{class:"danmaku-message"}," 赠送 ",-1),ee={class:"danmaku-gift-name"},te=Object(a["g"])("span",{class:"danmaku-message"}," × ",-1),ne={class:"danmaku-gift-num"},ae={key:3,class:"danmaku-content"},re=Object(a["g"])("span",{class:"danmaku-message"},"感谢 ",-1),ce={class:"danmaku-author-name"},ue={class:"danmaku-message"},ie={key:4,class:"danmaku-content"},oe={class:"danmaku-message"};function se(e,t,n,r,c,u){return Object(a["q"])(),Object(a["f"])("div",{class:Object(a["l"])(["danmaku-item",{hidden:r.isHidden}])},[n.showFace?(Object(a["q"])(),Object(a["f"])("div",{key:0,class:"danmaku-author-face",style:Object(a["n"])({backgroundImage:n.face?"url(".concat(n.face,")"):""})},null,4)):Object(a["e"])("",!0),"message"===n.type?(Object(a["q"])(),Object(a["f"])("div",$,[Object(a["g"])("span",{class:Object(a["l"])(["danmaku-author-name with-colon",{anchor:n.isAnchor,owner:n.isOwner}])},Object(a["z"])(n.uname),3),Object(a["g"])("span",Y,Object(a["z"])(n.message),1)])):"gift"===n.type?(Object(a["q"])(),Object(a["f"])("div",K,[Q,Object(a["g"])("span",V,Object(a["z"])(n.uname),1),Z,Object(a["g"])("span",ee,Object(a["z"])(n.giftName),1),te,Object(a["g"])("span",ne,Object(a["z"])(n.num),1)])):"sc"===n.type?(Object(a["q"])(),Object(a["f"])("div",ae,[re,Object(a["g"])("span",ce,Object(a["z"])(n.uname),1),Object(a["g"])("span",ue," 的SC："+Object(a["z"])(n.message),1)])):"info"===n.type?(Object(a["q"])(),Object(a["f"])("div",ie,[Object(a["g"])("span",oe,Object(a["z"])(n.message),1)])):Object(a["e"])("",!0)],2)}var le={props:{type:{type:String,default:"message"},showFace:Boolean,face:String,uid:Number,uname:String,message:String,isAnchor:Boolean,isOwner:Boolean,action:String,giftName:String,num:Number,stay:Number,hidden:Boolean},setup:function(e){var t=Object(a["v"])(!1),n=Object(a["v"])(!1);if(e.stay){var r=setTimeout((function(){t.value=!0,"info"===e.type&&setTimeout((function(){return n.value=!0}),800)}),e.stay);Object(a["o"])((function(){return clearTimeout(r)}))}var c=Object(a["b"])((function(){return e.hidden||t.value}));return Object(A["a"])(Object(A["a"])({},Object(a["A"])(e)),{},{isHidden:c,needRemoved:n})}};n("bca3");le.render=se;var fe=le,be=new Map,de={components:{DanmakuItem:fe},props:Object(A["a"])(Object(A["a"])({},c["d"]),{},{isGiftList:Boolean,giftShowFace:Boolean}),setup:function(e){var t=!0;Object(a["o"])((function(){return t=!1}));var n=Object(a["v"])([]),r=Object(a["v"])(null),c=Object(a["v"])(null);Object(a["p"])((function(){var e=r.value.getBoundingClientRect().top-5,t=function(){var t=n.value.findIndex((function(t){var n,a,r,c,u=null!==(n=null===(a=t.el)||void 0===a||null===(r=a.$el)||void 0===r?void 0:r.getBoundingClientRect())&&void 0!==n?n:{},i=u.top,o=void 0===i?e:i,s=u.height,l=void 0===s?0:s;return o<e&&(t.hidden=!0),o+l>e&&!(null!==(c=t.el)&&void 0!==c&&c.needRemoved)}));t>0&&n.value.splice(0,t)},c=setInterval(t,100);Object(a["o"])((function(){return clearInterval(c)}))}));var u=function(){var t=Object(a["B"])(e.isGiftList?c:r);t&&(t.scrollTop=t.scrollHeight)};e.isGiftList||(Object(a["p"])((function(){return window.addEventListener("resize",u)})),Object(a["o"])((function(){return window.removeEventListener("resize",u)})));var i=[],o=function e(){var r=200,c=i.length;c>0&&(r=Math.min(r,1e3/c),n.value.push(i.shift()),Object(a["k"])(u)),t&&setTimeout(e,r)};o();var s=function(){var t=Object(b["a"])(regeneratorRuntime.mark((function t(n){var a,r,c,u,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!n.showFace){t.next=19;break}return t.next=3,T(n.uid);case 3:if(a=t.sent,c=a.find((function(e){var t=Object(d["a"])(e,1),n=t[0];return r=be.get(n)}))||[""],u=Object(d["a"])(c,1),o=u[0],o){t.next=14;break}return r=X(a),be.set(o,r),t.next=10,r;case 10:o=t.sent,be.set(o,!0),t.next=18;break;case 14:if(!0===r){t.next=18;break}return t.next=17,r;case 17:o=t.sent;case 18:n.face=o;case 19:n.stay=n.stay||("bottom"===e.display?e.stay:0),i.push({props:n,key:Object(H["a"])(),el:null,hidden:!1});case 21:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),l=[];if(e.limit){var f=setInterval((function(){var t=l.splice(0);t.length&&(t.length>e.limit&&(t=B()(Object.keys(t),e.limit).sort().map((function(e){return t[e]}))),t.forEach((function(e){return s(e)})))}),1e3);Object(a["o"])((function(){return clearInterval(f)}))}var p=function(e){return l.push(e)};return Object(A["a"])(Object(A["a"])({},Object(a["A"])(e)),{},{danmakuList:n,danmakuListRef:r,giftListRef:c,addDanmaku:s,addSpeedLimitDanmaku:p})}};n("4998");de.render=F;var pe=de,je=(n("fb6a"),function(e){return Object(a["s"])("data-v-7d962cc2"),e=e(),Object(a["r"])(),e}),me={key:0,class:"jukebox-item"},ve={ref:"idlePlayer",loop:"",src:"http://music.163.com/song/media/outer/url?id=478507889.mp3"},Oe={class:"jukebox-item"},ge={class:"jukebox-info"},he=je((function(){return Object(a["g"])("span",{class:"jukebox-info"},'输入"点歌" + 歌名进行点歌',-1)})),ke={class:"jukebox-info"},ye={key:0,class:"jukebox-info"},we={key:1,class:"jukebox-info"},xe=je((function(){return Object(a["g"])("span",{class:"jukebox-info"},"正在播放: ",-1)})),Se={class:"jukebox-time"},Le={class:"jukebox-info"},Re={key:2},qe={class:"jukebox-info"},_e={class:"jukebox-item"},Te=Object(a["h"])(" —— "),Ee={key:1,class:"jukebox-item"};function Pe(e,t,n,r,c,u){return Object(a["q"])(),Object(a["f"])("div",null,[e.running?(Object(a["q"])(),Object(a["f"])("div",me,[Object(a["g"])("audio",ve,null,512),Object(a["g"])("audio",{ref:"player",src:"",onEnded:t[0]||(t[0]=function(){return r.audioEnded&&r.audioEnded.apply(r,arguments)}),onTimeupdate:t[1]||(t[1]=function(){return r.updatePlayer&&r.updatePlayer.apply(r,arguments)})},null,544),Object(a["g"])("div",Oe,[Object(a["g"])("div",ge,[he,Object(a["g"])("span",ke,[Object(a["g"])("button",{onClick:t[2]||(t[2]=function(){return r.nextSong&&r.nextSong.apply(r,arguments)})},"切歌")])]),e.isIdle?(Object(a["q"])(),Object(a["f"])("div",ye,"当前点歌列表为空")):(Object(a["q"])(),Object(a["f"])("div",we,[Object(a["g"])("div",null,[xe,Object(a["g"])("span",Se,Object(a["z"])(e.played)+"/"+Object(a["z"])(e.totalDuration),1)]),Object(a["g"])("div",Le,Object(a["z"])(e.playingName)+" —— "+Object(a["z"])(e.playingAuthor),1)])),r.playList.length>0?(Object(a["q"])(),Object(a["f"])("div",Re,[Object(a["g"])("div",qe,"播放列表：【"+Object(a["z"])(r.playList.length)+"】",1),Object(a["g"])("div",_e,[Object(a["g"])("ul",null,[(Object(a["q"])(!0),Object(a["f"])(a["a"],null,Object(a["w"])(r.playList.slice(0,3),(function(e,t){return Object(a["q"])(),Object(a["f"])("li",{class:"jukebox-song",key:t},[Object(a["g"])("span",null,Object(a["z"])(e.title),1),Te,Object(a["g"])("span",null,Object(a["z"])(e.author),1)])})),128))])])])):Object(a["e"])("",!0)])])):(Object(a["q"])(),Object(a["f"])("div",Ee,[Object(a["g"])("button",{onClick:t[3]||(t[3]=function(){return r.startJukebox&&r.startJukebox.apply(r,arguments)})},"启用点歌机")]))])}n("c975");var Ae=function(e){var t=parseInt(e),n=0;return t>=60&&(n=parseInt(t/60),t=parseInt(t%60)),t=t<10?"0"+t:t,n=n<10?"0"+n:n,n+":"+t},Ie=n("bc3a"),De=n.n(Ie),Me=n("4328"),Ne=n.n(Me),ze={props:c["d"],setup:function(e){var t=Object(a["v"])(null),n=Object(a["v"])(null),r=Object(a["v"])([]),c=[],u=Object(a["t"])({running:!1,isIdle:!0,played:"",totalDuration:"",playingName:"",playingAuthor:""}),i=function(){var e=Object(b["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:c.push(t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),o=function(){u.running=!0,Object(a["k"])((function(){n.value.play(),d()}))},s=function(){u.played=Ae(t.value.currentTime),u.totalDuration=Ae(t.value.duration)},l=function(){t.value.currentTime=t.value.duration},f=function(){if(console.log("play ended"),r.value.length>0){var e=r.value.shift();t.value.src=e.url,u.playingName=e.title,u.playingAuthor=e.author,n.value.pause(),t.value.play(),u.isIdle=!1}else n.value.play(),u.isIdle=!0},d=function e(){var a=200;if(u.running){var i=c.length;if(i>0){var o=c.shift(),s="";-1!==o.indexOf("-")&&(s=o.split("-")[1],o=o.split("-")[0]),De.a.post("http://xmsj.org/",Ne.a.stringify({input:o,type:"netease",filter:"name"}),{headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json","X-Requested-with":"XMLHttpRequest"}}).then(function(){var e=Object(b["a"])(regeneratorRuntime.mark((function e(a){var c,i,o,l;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(200!==a.status){e.next=22;break}c=Object(U["a"])(a.data.data),e.prev=2,o=regeneratorRuntime.mark((function e(){var a,c,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a=i.value,c=!1,!(a.author.indexOf(s)<0)){e.next=5;break}return console.log("not this author skip~"),e.abrupt("return","continue");case 5:return e.prev=5,o="https://music.163.com/song/media/outer/url?id="+a.songid+".mp3",e.next=9,De.a.get(o).then((function(e){-1!==e.headers["content-type"].indexOf("audio/mpeg")&&(u.isIdle?(u.isIdle=!1,n.value.pause(),u.playingName=a.title,u.playingAuthor=a.author,t.value.src=a.url,t.value.play()):r.value.push({title:a.title,url:o,author:a.author}),c=!0)}));case 9:if(!c){e.next=11;break}return e.abrupt("return","break");case 11:e.next=16;break;case 13:e.prev=13,e.t0=e["catch"](5),console.log("skip song"+a.songid);case 16:case"end":return e.stop()}}),e,null,[[5,13]])})),c.s();case 5:if((i=c.n()).done){e.next=14;break}return e.delegateYield(o(),"t0",7);case 7:if(l=e.t0,"continue"!==l){e.next=10;break}return e.abrupt("continue",12);case 10:if("break"!==l){e.next=12;break}return e.abrupt("break",14);case 12:e.next=5;break;case 14:e.next=19;break;case 16:e.prev=16,e.t1=e["catch"](2),c.e(e.t1);case 19:return e.prev=19,c.f(),e.finish(19);case 22:case"end":return e.stop()}}),e,null,[[2,16,19,22]])})));return function(t){return e.apply(this,arguments)}}())}}setTimeout(e,a)};return Object(A["a"])(Object(A["a"])(Object(A["a"])({},Object(a["A"])(e)),Object(a["A"])(u)),{},{idlePlayer:n,player:t,playList:r,nextSong:l,startJukebox:o,updatePlayer:s,audioEnded:f,orderSong:i})}};n("3ce6");ze.render=Pe,ze.__scopeId="data-v-7d962cc2";var Ce=ze,Fe={components:{Jukebox:Ce,DanmakuList:pe},props:c["d"],setup:function(e){var t=Object(a["v"])(null),n=Object(a["v"])(null),r=Object(a["v"])(null),c=new Map,u=Object(a["b"])((function(){return!["false","gift"].includes(e.face)})),i=function(t){n.value.addDanmaku({type:"info",message:t,stay:e.stay||5e3})},o=function(t){e.limit?n.value.addSpeedLimitDanmaku(t):n.value.addDanmaku(t);var a=t.message;r.value.running&&a.startsWith("点歌 ")&&r.value.orderSong(a.substr(3))};return Object(a["p"])((function(){console.log("正在连接直播弹幕服务器");var r=new I["KeepLiveWS"](e.room);Object(a["o"])((function(){return r.close()})),r.on("open",(function(){console.log("已连接直播弹幕服务器"),i("已连接直播弹幕服务器")})),r.on("live",(function(){console.log("已连接直播间",e.room),i("已连接直播间 ".concat(e.room))})),r.on("close",(function(){return console.log("已断开与直播弹幕服务器的连接")})),r.on("heartbeat",(function(e){return console.log("当前人气值",e)}));var s=e.giftPin?t:n;r.on("SEND_GIFT",(function(t){var n=t.data,a=n.uid,r=n.uname,u=n.action,i=n.giftName,o=n.num,l=n.face;if(_(a,l),e.giftComb){var f="".concat(a,"-").concat(i),b=c.get(f);b?c.set(f,Object(A["a"])(Object(A["a"])({},b),{},{num:b.num+o})):(c.set(f,{type:"gift",showFace:"false"!==e.face,uid:a,uname:r,action:u,giftName:i,num:o}),setTimeout((function(){s.value.addDanmaku(c.get(f)),c.delete(f)}),e.giftComb))}else s.value.addDanmaku({type:"gift",showFace:"false"!==e.face,uid:a,uname:r,action:u,giftName:i,num:o})})),r.on("DANMU_MSG",(function(t){var n=Object(d["a"])(t.info,3),a=n[1],r=Object(d["a"])(n[2],3),c=r[0],i=r[1],s=r[2],l={type:"message",showFace:u.value,uid:c,uname:i,message:a,isAnchor:c===e.anchor,isOwner:!!s};e.delay>0?setTimeout((function(){return o(l)}),1e3*e.delay):o(l)})),r.on("SUPER_CHAT_MESSAGE",(function(t){console.log("SUPER_CHAT_MESSAGE",t);var n=t.data,a=n.uid,r=n.user_info.uname,c=n.message;s.value.addDanmaku({type:"sc",showFace:"false"!==e.face,uid:a,uname:r,message:c})})),window.giftList=s,r.on("SUPER_CHAT_MESSAGE_JPN",(function(e){return console.log("SUPER_CHAT_MESSAGE_JPN",e)})),r.on("USER_TOAST_MSG",(function(t){var n=t.data,a=n.uid,r=n.username,c=n.role_name,u=n.num;s.value.addDanmaku({type:"gift",showFace:"false"!==e.face,uid:a,uname:r,giftName:c,num:u})}))})),{props:e,giftShowFace:u,giftPinList:t,danmakuList:n,jukebox:r}}};n("efbd");Fe.render=P;var Ge=Fe,Be={components:{Live:Ge,DanmakuItem:fe},setup:function(){var e=function(){return window.location.reload()};window.addEventListener("hashchange",e),Object(a["o"])((function(){return window.removeEventListener("hashchange",e)}));var t=Object(a["t"])(Object(c["c"])(window.location.hash)),n="true"===t.cors;o(n),w({method:t.face,expireDay:t.faceExpireDay});var r=Object(a["v"])(!1),u=Object(a["v"])("");return f("https://api.live.bilibili.com/room_ex/v1/RoomNews/get?roomid=".concat(t.room)).then((function(e){var n=e.code,a=e.msg,c=e.data,i=c.roomid,o=c.uid;0===n?(t.room=parseInt(i),t.anchor=parseInt(o),r.value=!0):u.value=a})).catch((function(){u.value="获取房间信息失败",n&&(u.value+="，请检查是否正确禁用了浏览器的 web security 以允许直接跨域")})),{props:t,ready:r,errMsg:u}}};n("2c9b");Be.render=r;var He=Be;Object(a["c"])(He).mount("#app")},cd73:function(e,t,n){},efbd:function(e,t,n){"use strict";n("3ff3")},f21b:function(e,t,n){}});